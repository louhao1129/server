# cellranger

-   为了实现“一次安装，全员可用”，把软件安装到 `/opt` 目录，并链接到 `/usr/local/bin` ，保持bin的整洁

给软链接起不同的名字（如 `cellranger10`、`cellranger9`），大家就可以根据自己的项目需求，显式地调用特定版本的软件，互不干扰。

下面是具体的操作步骤，以 **Cell Ranger v10** 为例（假设你也还要装 v9）：

------------------------------------------------------------------------

### 第一步：下载并安装到 `/opt`

**⚠️ 注意：** 10x Genomics 的下载链接包含特殊字符（如 `?`, `&`），**必须用双引号**把链接包起来，否则终端会报错。

1.  **进入临时目录下载：** `curl -o cellranger-10.0.0.tar.gz "https://cf.10xgenomics.com/releases/cell-exp/cellranger-10.0.0.tar.gz?Expires=..."`

2.  **解压：** `tar -xzvf cellranger-10.0.0.tar.gz`

3.  **移动到 `/opt` (这一步把家安好)：** `sudo mv cellranger-10.0.0 /opt/`

------------------------------------------------------------------------

### 第二步：制作带版本号的“快捷方式”

这是实现你想法的关键步骤。我们在 `/usr/local/bin` 里创建名字不同的软链接。

1.  **创建 `cellranger10` 命令：** `sudo ln -s /opt/cellranger-10.0.0/cellranger /usr/local/bin/cellranger10`

2.  **（假设你以后装了 v9）创建 `cellranger9` 命令：** `# 假设你已经把 v9 放在 /opt/cellranger-9.0.0 了     sudo ln -s /opt/cellranger-9.0.0/cellranger /usr/local/bin/cellranger9`

------------------------------------------------------------------------

### 第三步：设置一个“默认”版本（推荐）

为了方便大家（很多人懒得输数字），通常我们会把**最新版**或者**最常用版**设为默认的 `cellranger` 命令。

比如，让 `cellranger` 直接指向 v10：

``` bash
sudo ln -s /opt/cellranger-10.0.0/cellranger /usr/local/bin/cellranger
```

------------------------------------------------------------------------

# miniconda

为了实现“一次安装，全员可用”，我们需要把 Miniconda 安装在一个**公共目录**（通常是 `/opt`），并配置**全局环境变量**。

请按照以下步骤操作，全程需要使用 `sudo` 权限。

### 第一步：安装 Miniconda 到公共目录

我们要把它装在 `/opt/miniconda3`，这是一个专门存放第三方软件的标准目录。

1.  **下载安装脚本（如果还没下载）：** `wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh`

2.  **执行安装（关键步骤）：** 这里使用了 `-b` (静默模式) 和 `-p` (指定路径) 参数。 `sudo bash Miniconda3-latest-Linux-x86_64.sh -b -p /opt/miniconda3`

3.  **设置权限（确保所有人能读取和执行）：** 这一步保证了普通用户能运行里面的命令，但不能修改里面的文件（防止他们把环境搞坏）。 `sudo chmod -R 755 /opt/miniconda3`

------------------------------------------------------------------------

### 第二步：配置全局环境变量

我们需要让系统里的每个用户（包括未来的新用户）登录时，都能自动找到 conda。

最标准的方法是在 `/etc/profile.d/` 下创建一个配置脚本。

1.  **创建配置文件：** 使用编辑器新建文件（这里用 `nano`，你也可以用 `vim`）： `sudo nano /etc/profile.d/conda.sh`

2.  **填入内容：** 将下面这一行复制进去。这句话的意思是：利用 Conda 自带的脚本来初始化环境。`source /opt/miniconda3/etc/profile.d/conda.sh`

3.  **保存退出：**

    -   按 `Ctrl + O` 然后回车（保存）。
    -   按 `Ctrl + X` （退出）。

------------------------------------------------------------------------

### 第三步：验证效果

现在，配置已经完成了。你可以测试一下：

1.  **切换到 test 用户：** `bsu - test`

2.  **验证：** 第一次切换可能还没生效，重新登录或者手动生效一下：`ource /etc/profile.d/conda.sh     conda --version` 如果输出了版本号，说明成功了！

------------------------------------------------------------------------

### ⚠️ 一个极其重要的注意事项（必读）

按照这种方式安装后，**普通用户（如 test）在使用时会有以下特点**，请务必告诉你的用户：

1.  **无法直接在 `base` 环境安装包：** 如果 test 用户直接输入 `conda install numpy`，会报错 **"Permission denied"**。

    -   **原因：** `base` 环境在 `/opt` 目录下，属于 root，普通用户无权写入。这是为了安全，防止一个人把环境搞挂了影响所有人。

2.  **正确的使用姿势：建立自己的虚拟环境** 用户应该创建属于自己的环境，这样 Conda 会自动把环境存在用户的家目录（`~/.conda/envs/`）下，就没有权限问题了。

    **用户应该这样用：**

    ``` bash
    # 1. 创建一个新环境（比如叫 myenv）
    conda create -n myenv python=3.9

    # 2. 激活环境
    conda activate myenv

    # 3. 安装包（这时候随便装，完全自由）
    pip install torch
    ```

**总结：Conda 的可执行文件是共享的，但环境（Environments）应该是私有的。**

**编辑全局配置文件**

```{bash}
sudo nano /opt/miniconda3/.condarc

channels:
  - conda-forge
  - bioconda
  - defaults
```

# uv、pixi

# tmux、screen、zellij

```{bash}
sudo apt install screen -y

screen --version
```

```{bash}
sudo apt update

sudo apt install tmux -y

tmux -V
```

```{bash}
# 1. 下载最新版 (Linux x86_64)
curl -L https://github.com/zellij-org/zellij/releases/latest/download/zellij-x86_64-unknown-linux-musl.tar.gz -o zellij.tar.gz

# 2. 解压
tar -xzf zellij.tar.gz

# 3. 移动到公共目录并给执行权限
sudo mv zellij /usr/local/bin/
sudo chmod +x /usr/local/bin/zellij

# 4. 清理垃圾
rm zellij.tar.gz

# 5. 验证
zellij --version
```

# ncdu

```{bash}
sudo apt install ncdu -y
```